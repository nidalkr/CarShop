<div class="login-page" [ngClass]="{ 'login-page-compact': compact }">
  <div class="login-card">
    <!-- HEADER -->
    <div class="login-header">
      <div class="lock-icon" aria-hidden="true">
        <mat-icon>lock_outline</mat-icon>
      </div>
      <div class="header-text">
        <h2>Welcome back</h2>
        <p class="subtext">Sign in to continue your journey</p>
      </div>
    </div>

    <!-- ERROR BANNER -->
    <div *ngIf="errorMessage" class="error-banner" role="alert">
      <mat-icon>error_outline</mat-icon>
      <span>{{ errorMessage }}</span>
    </div>

    <!-- BODY -->
    <form
      class="login-body"
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
      novalidate
    >
      <!-- EMAIL -->
      <div class="form-field mb-3">
        <div class="label-row">
          <label for="email">Email address</label>
        </div>
        <div class="input-wrapper" [class.invalid]="showEmailError">
          <mat-icon>mail_outline</mat-icon>
          <input
            id="email"
            type="email"
            class="form-control auth-input"
            formControlName="email"
            placeholder="you@example.com"
            autocomplete="email"
            aria-describedby="emailHelp"
          />
        </div>
        <small
          id="emailHelp"
          class="helper-text"
          *ngIf="showEmailError"
        >
          {{ emailErrorMessage }}
        </small>
      </div>

      <!-- PASSWORD -->
      <div class="form-field mb-3">
        <div class="label-row">
          <label for="password">Password</label>
          <a class="link" routerLink="/auth/forgot-password">
            Forgot password?
          </a>
        </div>
        <div class="input-wrapper" [class.invalid]="showPasswordError">
          <mat-icon>lock_outline</mat-icon>
          <input
            id="password"
            [type]="hidePassword ? 'password' : 'text'"
            class="form-control auth-input"
            formControlName="password"
            placeholder="Enter your password"
            autocomplete="current-password"
            aria-describedby="passwordHelp"
          />
          <button
            type="button"
            class="toggle-visibility"
            (click)="hidePassword = !hidePassword"
            [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'"
          >
            <mat-icon>
              {{ hidePassword ? 'visibility' : 'visibility_off' }}
            </mat-icon>
          </button>
        </div>
        <small
          id="passwordHelp"
          class="helper-text"
          *ngIf="showPasswordError"
        >
          {{ passwordErrorMessage }}
        </small>
      </div>

      <!-- SUBMIT -->
      <button
  class="primary-button"
  type="submit"
  [disabled]="form.invalid || isLoading"
>
  <ng-container *ngIf="!isLoading; else loading">
    <span class="btn-label">Sign in</span>
    <mat-icon class="btn-icon">arrow_forward</mat-icon>
  </ng-container>

  <ng-template #loading>
    <mat-progress-spinner
      mode="indeterminate"
      diameter="18"
      strokeWidth="3"
    ></mat-progress-spinner>
    <span class="btn-label ms-2">Signing in...</span>
  </ng-template>
</button>


      <!-- SEPARATOR -->
      <div class="line-sep my-3"></div>

      <!-- REGISTER ROW -->
      <div class="register-row">
        <span>Don't have an account?</span>
        <a class="link" routerLink="/auth/register">Create one</a>
      </div>
    </form>
  </div>
</div>
